
Section 2:

Under Eq. (2) you have $f_{\rm EM}$ instead of $f_{\rm em}$, but at the start of Section 2 you have a $f_m$. Are these all interchangeable?

 ---> Fixed. $f_{\rm EM}$ is wrong, $f_{\rm em}$ is correct, the electromagnetic spin down. $f_m$ is the measured frequency which comes in in Equation 16.

Might want to spell out "... translate into red noise fluctions in the rotational phase $\phi(t)...$ (and thus the TOA residuals) after being filtered..."

 ---> This part was Andrew. I can make it more explicit but leaving as is for now to pass the "Andrew review"

Minor and stylistic, but should use \eqref{reflabel} and either "Equation" or "Eq.", rather than mixing

 ---> Good point. Equation(s) is now used throughout along with \eqref

Section 2.2 heading should be "Modulation of pulsar frequency by a GW", and first sentence should be "pulsar frequency" not "pulse frequency" (which in pulsar literature refers to the radio frequency at which the pulsar is emitting).

 ---> Agreed. Fixed

Do you mean "the pulsar TOAs" are modulated? Or "the pulsar frequency" is modulated?

 ---> To my mind they are effectively equivalent, i.e. 1/(TOA_2 - TOA_1) ~ f, but I accept this is somewhat imprecise conception and language. I think TOAs is fine here to match common terminology used by pulsar people, even though in this work we deal with frequencies... May revise this in future 

Do you actually work with "pulsar TOAs" or with pulsar frequencies?

 ---> As above

Why not just have 2\pi f_p in Eq. (13) --- do you use \omega later?

 ---> Yeah I take the point. \omega is used to match Maggiore and emphasise that it is measured in the MCRF. May change this, will consider.

What's the semi-colon in Eq. (13) and (17) mean? Could it just be a comma?

 ---> semicolon typically used to separate variables (i.e. t) from fixed parameters (i.e. x=0)

No need to define MCRF as acronym if it isn't used later.

 ---> Agreed. Fixed

"i.e. q is not a function of time" -> "i.e. neither q nor d is a function of time"

 ---> Good point! Fixed.

Should probably include a reference to tempo2? Not sure what it'd be, but Vargas2023 probably has it.
|
 ---> Done

Above Eq. (14), "the measured frequency" again makes me think of the radio frequency, not the pulsar spin frequency.

 ---> Again I take the point. This is the problem with formulating the pulse train as a photon, the language gets a little muddy. The equation applies generally to a photon, an give our photon conception I think this is ok for now, but will bear in mind..

Eq. (16) is a little unclear, I think it's saying f_p is a function of (t-d), while g is a function of just t? Maybe suppress the ^{(n)} for clarity? Or decrease spacing between function and argument parens? Obviously re-introduce when needed, i.e. next equation.

  ---> That is correct. I hoped from the intro at the start of Section 2 it was clear, but maybe not. Leaving as a stylistic point that will be fixed by journal.

One option for q^i is $q^{i,\,(n)}$ (I know super/subscript comma with indices can refer to derivatives, but context should be clear enough).

 --->This is also what I thought. It's a little ugly, but given that we both arrived at the same notation it is probably the best. I have included a little sentence after Eq. 17 to explain the notation.

Should have square brackets for the 1-exp term in Eq. (17)

 ---> Fixed

Typo as Eq. (17): "It is will also" (really the whole sentence is jumbled)

---> wtf sentence. Fixed.

Eq. (18) should be either three lines, or some of the second line should go on first. Nested parans should go {[()]}. 

---> Fixed

"Equations 16, 17, 18" -> "Equations (16)--(18)"

 ---> fixed

Again, "radio pulse frequency" refers to the carrier radio wave frequency, not the NS spin frequency measured at Earth.

---> New: "...that relates the intrinsic pulsar spin frequency to the frequency measured by an observer on Earth." Hopefully obvious from context that the "frequency" relates to the "spin frequency" mentioned earlier in the sentence.

Section 3:

Does the Kalman filter tell you the evolution (i.e. X as a function of time), or does it give you an estimate of X at the current time (given the past history)? My gut feeling is the latter, and the next paragraph implies as much.

---> I see what you are saying, but to my ear, both are effectively equivalent. We get the estimate of X at the current time, repeat for the next time, repeat for the next time,..., At the end of this process we have X(t).

"timestep $i = 1, ..., M$" -> "timestep indexed by $1 \leq i \leq M$" 

---> I like it. 

Why is the likelihood Gaussian, necessarily? What do the angled brackets in the definition of S_i represent? N in Eq. (24) is undefined until Section 4.1.2, I think. 

---> Angled brackets are just the averaging. Also used in e.g. Eq 3,4. Hopefully common enough notation not to explain. If required I'll add explanation in Section 2, under Eq 3.4. N is defined at the start of section 2. Likelihood is Gaussian since the KF is intrinsically Gaussian, i.e. the state and observation variables are assumed to be normal random variables. I will explain this more in the Appendix. 

Is Eq. (25) valid? I'd imagine each L_i is correlated, given they share much of the same data (i.e. the Kalman filter "looks back" and iteratively updates X as it sees more Y), so can you simply multiply the likelihoods together? 

---> Yep its valid. See e.g. https://bookdown.org/rdpeng/timeseriesbook/maximum-likelihood-with-the-kalman-filter.html I think confusion comes from the "look back" concept. Remember the KF is Markovian so at time t we have a prior estimate of the state, and a new single data point. We use just these two pieces of info to get a new estimate of the state.

(Sorry for all the "fundamental" questions around this section, I'm trying to imagine myself as a referee, and how they might read it.)

---> Fundamental + thorough is great. It is very appreciated - thanks Julian!

I think a slight re-ordering, making clear the order-of-operations would help a reader understand the Kalman + nested sampling setup. Something along the lines of: given one \theta, feed it to Kalman filter, which iteratively ingests the data given that \theta, and spits out a single log-likelihood (Eq. (25)), then return that log-likelihood to the sampler, which updates \theta via the MCMC in the nested sampler. This constructs the posterior for \theta. Maybe a small flowchart? I know Pat (and others) have used the setup in the past, but many of the readers of this paper wouldn't have that background.

--->I have included a small \begin{enumerate} at the end of Section 3.2. Not sure if this is needed or not, feels a bit out of place? Maybe a figure would be better.

Is M_1 really that of Section 2, given you later drop the pulsar terms?

---> Yeah good point. Changed to the less specific "we take M_1 to be the state space model that includes the presence of a GW" and then in Section 4.2.3 (Detection) make it clear that the model we use for the Bayes factors is the Earth terms model. 

Section 4:

What is "the system noise"? It isn't a term that's been previously defined

---> i.e. all noise processes. Process noise + measurement noise. To my ear its clear from context, but maybe should be more explicit

Cut "representative" from "representative synthetic data" (or define what it is representative of)

---> How about "we generate synthetic data that is astrophysically representative" ? I want to convey that we have chosen some physically reasonable parameter values, and not just stuck h=1, noise=tiny, RA=DEC=0 etc.

$q^n$ -> $q^{(n)}$ to match previous sections

--> fixed

We're back to $f_{em}$ rather than $f_m$, check for consistency!

---> $f_{em}$ is different to $f_m$. Maybe I should use a different symbol for $f_{em}$ to avoid the potential for any confusion.

"for all $n$" -> "for all pulsars"

---> I think since we define \gamma^n just before, "for all n" is more appropriate, but just a style judgement. No strong feelings either way.

The paragraph under Eq. (31) repeats itself about sufficient, qualitative, visually, etc. Should probably tighten it up.

---> Admittedly a bit clunky. TBD

Figure 3 doesn't entirely convince me, as you note in the caption: the yellow seems to have a quadratic (sinusoidal?) trend with time, whereas the blue is much more consistent with zero residuals as a function of time.

---> Agreed. Need to chat to Andres. This method of generating residuals is a bit of a black box to me currently. 

I don't understand what "Note that f_m^{(n)} is modified by..." sentence means. Are you saying that each pulsar's measured frequency will have a different measurement uncertainty in reality, but not in your simulated PTA? 

---> I am saying that both in reality and in our synthetic PTA the realisation of the noise is different for every pulsar. For our synthetic PTA all pulsars are sampled at the same time and so naively if we detect all pulsars with the same instrument at the same time we would expect the same noise realisation. But to be more "physical" we do different noise realisations.

I see in Eq. (33) and (34) that f_em is not f_m! This wasn't clear to me until now, and I'm still not sure what the difference is...

---> Addressed this above. 

"are selected arbitrarily, subject to being astrophysically reasonable and representative." -> "are selected to be astrophysically reasonable and representative."

---> Nice. I can imagine a reviewer saying "why these parameters?" hence the "arbitrarily", but removed for now since its a clunky sentence otherwise.

I balk a little at log-uniform priors with hard boundaries on \Omega and h_0 being "non-informative". All priors encode a belief about the parameter. Do we truly believe there should be exponentially more SMBBH at \Omega = 1e-9 than 1e-5? The prior on h0 is saying we believe that h_0 = 1e-15 is exponentially more likely than 1e-9. I know priors must be set (often arbitrarily), but we can just state them in the table without claiming they are uninformative. What'd be best is showing that the inference is broadly insensitive to the choice of prior, but I imagine this might be computationally prohibitive.

---> To discuss. By LogUniform I effectively mean sample X from U(-9,-5) and then calculate h = pow(base,X). i.e. uniformly sampled in log space. I think this is standard e.g. Table 2 Meyers: https://arxiv.org/abs/2101.12421

Typos Table 1: Sin, Cosine can't be priors. You should have \cos \delta and \cos \iota having Uniform priors. The bounds on h_0 prior are swapped. You say in the text you allow \pm1% on the f and dotf, but the table implies 10%.  

---> f and fdot fixed. h_0 ordering fixed. Re sin/cos priors, it doesn't matter too much since we are not overly sensitive to choice of prior, and we are currently actually just using uniform priors in any case, I just haven't updated the table properly. Table 1 of https://arxiv.org/abs/2008.12320 suggests Sin/Cos priors are a thing...I was planning to use the same priors to be more "proper".

What are f_{\rm ATNF}^n, \dot{f}_{\rm ATNF}^n aren't defined. I can interpret them, but it's not eminently clear.

---> Table caption: "The subscript ``ATNF" denotes values which have been obtained from the ATNF pulsar catalogue as described in Section X". Is this sufficient?

Why quote the mean errors in the ATNF if you really want to say that they're typically tiny (via the median)? Just cut the mean errors bit to shorten the paragraph.

---> Yeah nice idea. Fixed.

I'm really not sure whether the \pm1% on frequency/frequency deriv is justifiable: there is no radio pulsar timed that badly, and if there were, it would never be included into a PTA... Saying you use those wide priors for computational reasons is more justifiable, in my opinion.

---> Yeah I have been thinking the same. I am just conscious of the difference between the standard way of doing things, i.e. running complete pulsar pipeline, fitting all effects, saying "at t=0 the frequency is 300 Hz with tiny errors" and THEN looking for GW in the residuals vs our approach of just estimating everything simultaneously and consistently. I think this is why Andrew was keen to also estimate f,fdot rather than taking them as knowns. Discussing here is clunky, will discuss with you in person. Stricter priors will only help us so its no big deal either way. 

$[\gamma^{(n)}]^{-1} >> T_{\rm obs}$ -> $[\gamma^{(n)}]^{-1} \gg T_{\rm obs}$

---> Fixed

"the results are unchanged" which results? in Section 4.2.2?

---> Yeah so all results in the paper are effectively independent of prior/choice of \gamma

I know the "pulsar terms" phrase is common parlance, but it slightly confused me that you could drop all "pulsar terms from the model" but still be estimating \theta_{\rm psr,reduced}

---> Joe had the same confusion. Not sure how to be clearer. To discuss. 

The discussion of Fig 4 should be tightened. What do you mean "accurately estimate"? That the injected value is included within a 90% credible interval of the posterior? The \iota problem should be noted/explained (I know this is a personal bugbear, but \iota is clearly the problem parameter in Fig 4). The median of the posterior is not generally a useful summary -- while it's neat that it matches the injection, you should actually expect that for ~7 parameters, some of the should have the injected value somewhere further away than the median. The units in the subscripts of the parameters is also odd in my opinion, especially as it isn't elsewhere in the text.

--->We now talk more specifically in terms of credible intervals rather than "accurately". The \iota problem is now noted and discussion deferred to later sections. I retain some discussion of posterior medians just to make the point that for some posteriors, the medians are identically correct whilst for others they are shifted - this is useful just to lay the ground for the later discussion of the bias from dropping the pulsar terms. Units have been removed from parameter subscripts. Discussion on the other parameters, c.f. Figure 5 has now been dropped.


Fig 5 could maybe be collapsed somehow? Like, what if you show or state the fraction of pulsars for which the 90% credible interval contains the injected f, f_dot, sigma? As you say, it isn't the goal of the method to estimate these pulsar parameters precisely. In fact, showing your posteriors on f that are "so big" (i.e. ~0.3 Hz wide) might worry pulsar astronomers, as frequencies are "easy" to measure to much higher precision.

---> Just dropping Figure 5 for now. Can add back in later if necessary, but it is somewhat uninteresting to show. I think it is sufficient to just state that we also infer the f,fdot etc.

"a bias that results from dropping the Earth terms" --- do you mean pulsar terms?

---> Yes, fixed.

I agree that discussion of the "bumps" is probably a technical detail that doesn't require so much text. However, I think discussing it in terms of the h0 at which the algorithm can no longer guarantee Z(M_1) > Z(M_0) is important.


--->Yup nice idea. Will keep that part.

The question of upper limit or sensitivity of the method is important, i.e. what does h_0 ~ 3e-15 depend on? I imagine T_obs, M, the location of the source w.r.t the PTA. Can/should we quantify any of this dependence? I think at least listing, and qualitatively discussing it is important.

---> In Section 4.3 we will have some exploration of this, but in terms of Bayes factors on the sky, rather than minimal detectable strain, since it is cheaper to compute. I have added in a few sentences to 4.2.3 to qualitatively discuss factors which influence min h_0 as suggested.

4.2.4 first sentence remove "just"

---> Fixed

My comments of Fig 4 also apply to Fig 7. I think it better to precisely talk about injected values vs. posterior credible intervals, rather than the more colloquiual "fidelity" "variance", etc. 

---> Updated as suggested. I retain "variance" for now to describe that e.g. the 1D posterior for \Omega for noise realisation 1 is very very similar to the 1D posterior for \Omega for noise realisation 2. We could describe this quantitatively (e.g. Wasserstein?) but I think it is sufficient to say "hey look all these posteriors look the same".

The discussion of the h_0/\iota problem does not really explain things adequately for me. Partly because I can't see how h_plus, h_cross feed into the measurement equation, I can't see how they are identifiable. If they are identifiable formally, why is the likelihood surface so insensitive to the data? naively they seem to be a pre-factor, which scales g. I also can't see why iota in particular is sensitive to dropping the pulsar terms.

---> Its a good point. Need to think about this.

Again, I wouldn't talk about "variance", but instead credible intervals of the posterior. My points about Fig 5 also apply to Fig 9 -- the median of a posterior is not very informative, better to ask whether the injected values lie within a credible interval.

---> Edited re credible intervals c.f. above. Plots to be discussed - I know Joe has done these kinds of plots before.


Section 5:

I'd worry a bit about scope-creep! I think this paper has enough good stuff already to publish, and many of those questions can be answered in follow-ups.

---> Agreed. Most of these points will be relegated to "we could do this in the future"



Dear Lucy and Thomas,
Congratulations! Your Tenancy Application for the above property has been approved. For any matters pertaining to your tenancy, please feel free to contact me moving forward on 0488 031 170 or patreacegannan@jelliscraig.com.au.

